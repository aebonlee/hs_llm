import{j as e}from"./ui-vendor-rcE90lUk.js";import{r as m}from"./react-vendor-oaxG2rvL.js";import{P as B,C as g,a as v,b as N,c as f,d as C,D as G}from"./PageTitle-CPjV8G71.js";import{S as l}from"./simple-button-Bcp3Kz7o.js";import{I as n,T as x,S as W}from"./textarea-B6xEFEVD.js";import{c as H,u as P,C as k}from"./index-BBL6hUfz.js";import{S as K}from"./sparkles-BGfxdTa4.js";import{T as O}from"./trash-2-CrE-6XGG.js";import"./pdf-vendor-h9Wj2YyB.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=H("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);function ee(){const{generateContent:T,isGenerating:b,generatedContent:d,exportContent:D}=P(),[w,z]=m.useState(""),[y,E]=m.useState(""),[t,c]=m.useState([]),[h,F]=m.useState(""),R=()=>{const s={id:Date.now().toString(),name:"",description:"",weight:.25,levels:[{id:"1",name:"우수",score:4,description:""},{id:"2",name:"양호",score:3,description:""},{id:"3",name:"보통",score:2,description:""},{id:"4",name:"미흡",score:1,description:""}]};c([...t,s])},p=(s,a,r)=>{c(t.map(i=>i.id===s?{...i,[a]:r}:i))},j=(s,a,r,i)=>{c(t.map(o=>o.id===s?{...o,levels:o.levels.map(u=>u.id===a?{...u,[r]:i}:u)}:o))},L=s=>{c(t.filter(a=>a.id!==s))},M=async()=>{try{const{apiKey:s}=P.getState();if(!s||s.trim()===""){alert("API 키가 설정되지 않았습니다. 설정 페이지에서 OpenAI API 키를 입력해주세요.");return}await T("rubric",{title:w,description:y,prompt:h})}catch(s){console.error("루브릭 생성 실패:",s),alert("루브릭 생성 중 오류가 발생했습니다. API 키를 확인하거나 다시 시도해주세요.")}},I=t.reduce((s,a)=>s+a.weight,0),S=Math.abs(I-1)>.01,A=s=>{D(s)};return e.jsxs("div",{className:"space-y-8 animate-fadeIn",children:[e.jsx(B,{icon:k,title:"루브릭 빌더",description:"평가 기준표 생성 및 관리"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs(g,{children:[e.jsxs(v,{children:[e.jsx(N,{children:"루브릭 정보"}),e.jsx(f,{children:"루브릭의 기본 정보를 입력하세요"})]}),e.jsxs(C,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"루브릭 제목"}),e.jsx(n,{value:w,onChange:s=>z(s.target.value),placeholder:"예: 프로그래밍 과제 평가"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"설명"}),e.jsx(x,{value:y,onChange:s=>E(s.target.value),placeholder:"루브릭 사용 목적과 평가 방법을 설명하세요",rows:3})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("label",{className:"text-sm font-medium",children:"AI 생성 프롬프트"}),e.jsx(x,{value:h,onChange:s=>F(s.target.value),placeholder:"AI에게 어떤 루브릭을 만들어 달라고 요청하세요",rows:3}),e.jsx(l,{onClick:M,disabled:b||!h,className:"w-full mt-2",size:"sm",variant:"primary",children:b?e.jsx("span",{children:"생성 중..."}):e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:"AI로 생성"})]})})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"가중치 합계"}),e.jsx("span",{className:`text-sm ${S?"text-red-600":"text-green-600"}`,children:I.toFixed(2)})]}),S&&e.jsx("p",{className:"text-xs text-red-600",children:"가중치의 합이 1이 되어야 합니다"})]})]})]}),e.jsxs(g,{className:"lg:col-span-2",children:[e.jsx(v,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(N,{children:"평가 기준"}),e.jsx(f,{children:"각 평가 기준과 수준을 정의하세요"})]}),e.jsxs(l,{onClick:R,size:"sm",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"기준 추가"]})]})}),e.jsxs(C,{className:"space-y-6",children:[t.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(k,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"평가 기준을 추가해보세요"})]}):t.map(s=>e.jsxs("div",{className:"border rounded-lg p-4 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx("div",{className:"col-span-2",children:e.jsx(n,{value:s.name,onChange:a=>p(s.id,"name",a.target.value),placeholder:"평가 기준명"})}),e.jsx("div",{children:e.jsx(n,{type:"number",step:"0.01",min:"0",max:"1",value:s.weight,onChange:a=>p(s.id,"weight",parseFloat(a.target.value)),placeholder:"가중치"})})]}),e.jsx(x,{value:s.description,onChange:a=>p(s.id,"description",a.target.value),placeholder:"평가 기준 설명",rows:2})]}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>L(s.id),className:"ml-2 text-red-600 hover:text-red-700",children:e.jsx(O,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.levels.map(a=>e.jsxs("div",{className:"border rounded p-3 space-y-2",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(n,{value:a.name,onChange:r=>j(s.id,a.id,"name",r.target.value),placeholder:"수준명",className:"flex-1"}),e.jsx(n,{type:"number",value:a.score,onChange:r=>j(s.id,a.id,"score",parseInt(r.target.value)),placeholder:"점수",className:"w-20"})]}),e.jsx(x,{value:a.description,onChange:r=>j(s.id,a.id,"description",r.target.value),placeholder:"수준별 설명",rows:2})]},a.id))})]},s.id)),t.length>0&&e.jsxs("div",{className:"flex space-x-2 pt-4 border-t",children:[e.jsxs(l,{onClick:()=>A("pdf"),variant:"outline",size:"sm",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"PDF 내보내기"]}),e.jsxs(l,{onClick:()=>A("json"),variant:"outline",size:"sm",children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"저장"]})]})]})]})]}),(d==null?void 0:d.type)==="rubric"&&e.jsxs(g,{children:[e.jsxs(v,{children:[e.jsx(N,{children:"AI 생성 루브릭"}),e.jsx(f,{children:"AI가 생성한 루브릭을 확인하고 편집하세요"})]}),e.jsx(C,{children:e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 max-h-96 overflow-y-auto",children:e.jsx("pre",{className:"whitespace-pre-wrap text-sm",children:d.content})})})]})]})}export{ee as RubricBuilder};
