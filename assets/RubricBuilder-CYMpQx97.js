import{j as e}from"./ui-vendor-rcE90lUk.js";import{r as m}from"./react-vendor-oaxG2rvL.js";import{P as M,C as N,a as f,b as C,c as b,d as w,D as G}from"./PageTitle-BS5QI4b5.js";import{A as U}from"./action-button-CgjjQ8rI.js";import{c as W,u as S,C as P,U as x}from"./index-BI7WhaaC.js";import{I as l,T as h,S as H}from"./textarea-MDdIAiCI.js";import{S as K}from"./sparkles-CvxrqN2C.js";import{T as O}from"./trash-2-xS4t9hY4.js";import"./pdf-vendor-h9Wj2YyB.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=W("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);function se(){const{generateContent:k,isGenerating:T,generatedContent:n,exportContent:D}=S(),[p,z]=m.useState(""),[j,E]=m.useState(""),[r,d]=m.useState([]),[c,R]=m.useState(""),B=()=>{const s={id:Date.now().toString(),name:"",description:"",weight:.25,levels:[{id:"1",name:"우수",score:4,description:""},{id:"2",name:"양호",score:3,description:""},{id:"3",name:"보통",score:2,description:""},{id:"4",name:"미흡",score:1,description:""}]};d([...r,s])},u=(s,a,t)=>{d(r.map(i=>i.id===s?{...i,[a]:t}:i))},g=(s,a,t,i)=>{d(r.map(o=>o.id===s?{...o,levels:o.levels.map(v=>v.id===a?{...v,[t]:i}:v)}:o))},F=s=>{d(r.filter(a=>a.id!==s))},L=async()=>{console.log("AI로 생성 버튼 클릭!",{rubricTitle:p,rubricDescription:j,aiPrompt:c});try{const{apiKey:s}=S.getState();if(!s||s.trim()===""){alert("API 키가 설정되지 않았습니다. 설정 페이지에서 OpenAI API 키를 입력해주세요.");return}await k("rubric",{title:p,description:j,prompt:c})}catch(s){console.error("루브릭 생성 실패:",s),alert("루브릭 생성 중 오류가 발생했습니다. API 키를 확인하거나 다시 시도해주세요.")}},y=r.reduce((s,a)=>s+a.weight,0),I=Math.abs(y-1)>.01,A=s=>{D(s)};return e.jsxs("div",{className:"space-y-8 animate-fadeIn",children:[e.jsx(M,{icon:P,title:"루브릭 빌더",description:"평가 기준표 생성 및 관리"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs(N,{children:[e.jsxs(f,{children:[e.jsx(C,{children:"루브릭 정보"}),e.jsx(b,{children:"루브릭의 기본 정보를 입력하세요"})]}),e.jsxs(w,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"루브릭 제목"}),e.jsx(l,{value:p,onChange:s=>z(s.target.value),placeholder:"예: 프로그래밍 과제 평가"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"설명"}),e.jsx(h,{value:j,onChange:s=>E(s.target.value),placeholder:"루브릭 사용 목적과 평가 방법을 설명하세요",rows:3})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("label",{className:"text-sm font-medium",children:"AI 생성 프롬프트"}),e.jsx(h,{value:c,onChange:s=>R(s.target.value),placeholder:"AI에게 어떤 루브릭을 만들어 달라고 요청하세요",rows:3}),e.jsxs(U,{onClick:L,disabled:!c,loading:T,className:"w-full mt-2",size:"sm",variant:"generate",children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:"AI로 생성"})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"가중치 합계"}),e.jsx("span",{className:`text-sm ${I?"text-red-600":"text-green-600"}`,children:y.toFixed(2)})]}),I&&e.jsx("p",{className:"text-xs text-red-600",children:"가중치의 합이 1이 되어야 합니다"})]})]})]}),e.jsxs(N,{className:"lg:col-span-2",children:[e.jsx(f,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(C,{children:"평가 기준"}),e.jsx(b,{children:"각 평가 기준과 수준을 정의하세요"})]}),e.jsxs(x,{onClick:B,size:"sm",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"기준 추가"]})]})}),e.jsxs(w,{className:"space-y-6",children:[r.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(P,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"평가 기준을 추가해보세요"})]}):r.map(s=>e.jsxs("div",{className:"border rounded-lg p-4 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx("div",{className:"col-span-2",children:e.jsx(l,{value:s.name,onChange:a=>u(s.id,"name",a.target.value),placeholder:"평가 기준명"})}),e.jsx("div",{children:e.jsx(l,{type:"number",step:"0.01",min:"0",max:"1",value:s.weight,onChange:a=>u(s.id,"weight",parseFloat(a.target.value)),placeholder:"가중치"})})]}),e.jsx(h,{value:s.description,onChange:a=>u(s.id,"description",a.target.value),placeholder:"평가 기준 설명",rows:2})]}),e.jsx(x,{variant:"outline",size:"sm",onClick:()=>F(s.id),className:"ml-2 text-red-600 hover:text-red-700",children:e.jsx(O,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.levels.map(a=>e.jsxs("div",{className:"border rounded p-3 space-y-2",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(l,{value:a.name,onChange:t=>g(s.id,a.id,"name",t.target.value),placeholder:"수준명",className:"flex-1"}),e.jsx(l,{type:"number",value:a.score,onChange:t=>g(s.id,a.id,"score",parseInt(t.target.value)),placeholder:"점수",className:"w-20"})]}),e.jsx(h,{value:a.description,onChange:t=>g(s.id,a.id,"description",t.target.value),placeholder:"수준별 설명",rows:2})]},a.id))})]},s.id)),r.length>0&&e.jsxs("div",{className:"flex space-x-2 pt-4 border-t",children:[e.jsxs(x,{onClick:()=>A("pdf"),variant:"outline",size:"sm",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"PDF 내보내기"]}),e.jsxs(x,{onClick:()=>A("json"),variant:"outline",size:"sm",children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"저장"]})]})]})]})]}),(n==null?void 0:n.type)==="rubric"&&e.jsxs(N,{children:[e.jsxs(f,{children:[e.jsx(C,{children:"AI 생성 루브릭"}),e.jsx(b,{children:"AI가 생성한 루브릭을 확인하고 편집하세요"})]}),e.jsx(w,{children:e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 max-h-96 overflow-y-auto",children:e.jsx("pre",{className:"whitespace-pre-wrap text-sm",children:n.content})})})]})]})}export{se as RubricBuilder};
