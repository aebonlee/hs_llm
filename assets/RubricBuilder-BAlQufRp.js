import{j as e}from"./ui-vendor-rcE90lUk.js";import{r as x}from"./react-vendor-oaxG2rvL.js";import{P as B,C as N,a as f,b as C,c as b,d as w,D as G}from"./PageTitle-CVns3HoY.js";import{S as l}from"./simple-button-C17lWSHC.js";import{I as n,T as h,S as W}from"./textarea-DnKq4YkJ.js";import{c as H,u as P,C as k}from"./index-Mtcv8sn0.js";import{S as K}from"./sparkles-Z3bH_94e.js";import{T as O}from"./trash-2-CAbfZsp8.js";import"./pdf-vendor-h9Wj2YyB.js";/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=H("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);function ee(){const{generateContent:T,isGenerating:y,generatedContent:d,exportContent:D}=P(),[p,z]=x.useState(""),[j,E]=x.useState(""),[t,c]=x.useState([]),[o,F]=x.useState(""),R=()=>{const s={id:Date.now().toString(),name:"",description:"",weight:.25,levels:[{id:"1",name:"우수",score:4,description:""},{id:"2",name:"양호",score:3,description:""},{id:"3",name:"보통",score:2,description:""},{id:"4",name:"미흡",score:1,description:""}]};c([...t,s])},u=(s,a,r)=>{c(t.map(i=>i.id===s?{...i,[a]:r}:i))},g=(s,a,r,i)=>{c(t.map(m=>m.id===s?{...m,levels:m.levels.map(v=>v.id===a?{...v,[r]:i}:v)}:m))},L=s=>{c(t.filter(a=>a.id!==s))},M=async()=>{console.log("AI로 생성 버튼 클릭!",{rubricTitle:p,rubricDescription:j,aiPrompt:o});try{const{apiKey:s}=P.getState();if(!s||s.trim()===""){alert("API 키가 설정되지 않았습니다. 설정 페이지에서 OpenAI API 키를 입력해주세요.");return}await T("rubric",{title:p,description:j,prompt:o})}catch(s){console.error("루브릭 생성 실패:",s),alert("루브릭 생성 중 오류가 발생했습니다. API 키를 확인하거나 다시 시도해주세요.")}},I=t.reduce((s,a)=>s+a.weight,0),A=Math.abs(I-1)>.01,S=s=>{D(s)};return e.jsxs("div",{className:"space-y-8 animate-fadeIn",children:[e.jsx(B,{icon:k,title:"루브릭 빌더",description:"평가 기준표 생성 및 관리"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs(N,{children:[e.jsxs(f,{children:[e.jsx(C,{children:"루브릭 정보"}),e.jsx(b,{children:"루브릭의 기본 정보를 입력하세요"})]}),e.jsxs(w,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"루브릭 제목"}),e.jsx(n,{value:p,onChange:s=>z(s.target.value),placeholder:"예: 프로그래밍 과제 평가"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium",children:"설명"}),e.jsx(h,{value:j,onChange:s=>E(s.target.value),placeholder:"루브릭 사용 목적과 평가 방법을 설명하세요",rows:3})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("label",{className:"text-sm font-medium",children:"AI 생성 프롬프트"}),e.jsx(h,{value:o,onChange:s=>F(s.target.value),placeholder:"AI에게 어떤 루브릭을 만들어 달라고 요청하세요",rows:3}),e.jsx(l,{onClick:M,disabled:y||!o,className:"w-full mt-2",size:"sm",variant:"primary",children:y?e.jsx("span",{children:"생성 중..."}):e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:"AI로 생성"})]})})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:"가중치 합계"}),e.jsx("span",{className:`text-sm ${A?"text-red-600":"text-green-600"}`,children:I.toFixed(2)})]}),A&&e.jsx("p",{className:"text-xs text-red-600",children:"가중치의 합이 1이 되어야 합니다"})]})]})]}),e.jsxs(N,{className:"lg:col-span-2",children:[e.jsx(f,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx(C,{children:"평가 기준"}),e.jsx(b,{children:"각 평가 기준과 수준을 정의하세요"})]}),e.jsxs(l,{onClick:R,size:"sm",children:[e.jsx($,{className:"h-4 w-4 mr-2"}),"기준 추가"]})]})}),e.jsxs(w,{className:"space-y-6",children:[t.length===0?e.jsxs("div",{className:"text-center py-8 text-muted-foreground",children:[e.jsx(k,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"평가 기준을 추가해보세요"})]}):t.map(s=>e.jsxs("div",{className:"border rounded-lg p-4 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsx("div",{className:"col-span-2",children:e.jsx(n,{value:s.name,onChange:a=>u(s.id,"name",a.target.value),placeholder:"평가 기준명"})}),e.jsx("div",{children:e.jsx(n,{type:"number",step:"0.01",min:"0",max:"1",value:s.weight,onChange:a=>u(s.id,"weight",parseFloat(a.target.value)),placeholder:"가중치"})})]}),e.jsx(h,{value:s.description,onChange:a=>u(s.id,"description",a.target.value),placeholder:"평가 기준 설명",rows:2})]}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>L(s.id),className:"ml-2 text-red-600 hover:text-red-700",children:e.jsx(O,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.levels.map(a=>e.jsxs("div",{className:"border rounded p-3 space-y-2",children:[e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(n,{value:a.name,onChange:r=>g(s.id,a.id,"name",r.target.value),placeholder:"수준명",className:"flex-1"}),e.jsx(n,{type:"number",value:a.score,onChange:r=>g(s.id,a.id,"score",parseInt(r.target.value)),placeholder:"점수",className:"w-20"})]}),e.jsx(h,{value:a.description,onChange:r=>g(s.id,a.id,"description",r.target.value),placeholder:"수준별 설명",rows:2})]},a.id))})]},s.id)),t.length>0&&e.jsxs("div",{className:"flex space-x-2 pt-4 border-t",children:[e.jsxs(l,{onClick:()=>S("pdf"),variant:"outline",size:"sm",children:[e.jsx(G,{className:"h-4 w-4 mr-2"}),"PDF 내보내기"]}),e.jsxs(l,{onClick:()=>S("json"),variant:"outline",size:"sm",children:[e.jsx(W,{className:"h-4 w-4 mr-2"}),"저장"]})]})]})]})]}),(d==null?void 0:d.type)==="rubric"&&e.jsxs(N,{children:[e.jsxs(f,{children:[e.jsx(C,{children:"AI 생성 루브릭"}),e.jsx(b,{children:"AI가 생성한 루브릭을 확인하고 편집하세요"})]}),e.jsx(w,{children:e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 max-h-96 overflow-y-auto",children:e.jsx("pre",{className:"whitespace-pre-wrap text-sm",children:d.content})})})]})]})}export{ee as RubricBuilder};
